<Project Sdk="Microsoft.NET.Sdk.Web">
  <PropertyGroup>
    <TargetFramework>netcoreapp2.2</TargetFramework>
    <UserSecretsId>c9b7e1c3-1564-4d7d-85ea-3455587a330d</UserSecretsId>
    <AssemblyName>BitShuva.Chavah</AssemblyName>
    <RootNamespace>BitShuva.Chavah</RootNamespace>
    <TypeScriptCompileBlocked>false</TypeScriptCompileBlocked>
    <TypeScriptToolsVersion>Latest</TypeScriptToolsVersion>
    <RestoreSources>$(RestoreSources);https://api.nuget.org/v3/index.json</RestoreSources>
    <DockerComposeProjectPath>..\docker-compose.dcproj</DockerComposeProjectPath>
    <GenerateDocumentationFile>true</GenerateDocumentationFile>
    <AspNetCoreHostingModel>InProcess</AspNetCoreHostingModel>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|AnyCPU'">
    <NoWarn>1701;1702;1591;</NoWarn>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|AnyCPU'">
    <NoWarn>1701;1702;1591;</NoWarn>
  </PropertyGroup>
  <ItemGroup>
    <PackageReference Include="AutoMapper.Extensions.Microsoft.DependencyInjection" Version="6.0.0" />
    <PackageReference Include="BCrypt.Net-Next" Version="3.1.3" />
    <PackageReference Include="BuildBundlerMinifier" Version="2.8.391" />
    <PackageReference Include="BuildWebCompiler" Version="1.12.394" />
    <PackageReference Include="cloudscribe.Syndication.Web" Version="2.1.2" />
    <PackageReference Include="CoreFtp" Version="1.4.0" />
    <PackageReference Include="DalSoft.Hosting.BackgroundQueue" Version="1.0.4" />
    <PackageReference Include="Microsoft.AspNetCore.App" />
    <PackageReference Include="Microsoft.AspNetCore.Mvc.Versioning.ApiExplorer" Version="3.2.0" />
    <PackageReference Include="Microsoft.AspNetCore.ResponseCompression" Version="2.2.0" />
    <PackageReference Include="Microsoft.Extensions.PlatformAbstractions" Version="1.1.0" />
    <PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="2.2.1" PrivateAssets="All" />
    <PackageReference Include="Microsoft.SyndicationFeed.ReaderWriter" Version="1.0.2" />
    <PackageReference Include="Microsoft.Web.LibraryManager.Build" Version="1.0.172" />
    <PackageReference Include="Optional" Version="4.0.0" />
    <PackageReference Include="Pwned.AspNetCore" Version="1.0.4" />
    <PackageReference Include="Quartz" Version="3.0.7" />
    <PackageReference Include="RavenDB.Client" Version="4.1.3" />
    <PackageReference Include="RavenDB.Identity" Version="4.4.1" />
    <PackageReference Include="RavenDB.StructuredLogger" Version="4.0.7" />
    <PackageReference Include="RavenMigrations" Version="4.1.7" />
    <PackageReference Include="Sendgrid" Version="9.10.0" />
    <PackageReference Include="SimpleSitemap" Version="3.0.0" />
    <PackageReference Include="Swashbuckle.AspNetCore" Version="4.0.1" />
    <PackageReference Include="System.Interactive" Version="3.2.0" />
    <PackageReference Include="WebPush" Version="1.0.11" />
  </ItemGroup>

  <ItemGroup>

    <Content Remove="Views\Partials\**" />
    <Compile Remove="Views\Partials\**" />
    <None Remove="Views\Partials\**" />
    <EmbeddedResource Remove="Views\Partials\**" />

    <Content Remove="wwwroot\js\Components\**" />
    <Compile Remove="wwwroot\js\Components\**" />
    <None Remove="wwwroot\js\Components\**" />
    <EmbeddedResource Remove="wwwroot\js\Components\**" />

    <Content Include="wwwroot\js\**\*.ts" />
    <Content Remove="wwwroot\js\**\*.ts" />

    <Content Remove="wwwroot\js\dist\**" />
    <Compile Remove="wwwroot\js\dist\**" />
    <None Remove="wwwroot\js\dist\**" />

    <Content Remove="wwwroot\css\dist\**" />
    <Compile Remove="wwwroot\css\dist\**" />
    <Content Remove="wwwroot\css\**\*.less" />
    <None Remove="wwwroot\css\dist\**" />

    <None Include="wwwroot\css\**\*.less" />

    <Content Remove="node_modules\**" />

  </ItemGroup>

  <ItemGroup>
    <None Update="Models\**\*.cs">
      <DependentUpon>%(Filename).d.ts</DependentUpon>
    </None>
    <None Update="ravencert.*.pfx">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <Target Name="PublishMinifiedDistributionFiles" AfterTargets="ComputeFilesToPublish">
    <!-- Include the newly-built files in the publish output -->
    <ItemGroup>
      <DistFiles Include="wwwroot\css\dist\**" />
      <ResolvedFileToPublish Include="@(DistFiles->'%(FullPath)')" Exclude="@(ResolvedFileToPublish)">
        <RelativePath>%(DistFiles.Identity)</RelativePath>
        <CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
      </ResolvedFileToPublish>
    </ItemGroup>
    <ItemGroup>
      <DistFiles Include="wwwroot\js\dist\**" />
      <ResolvedFileToPublish Include="@(DistFiles->'%(FullPath)')" Exclude="@(ResolvedFileToPublish)">
        <RelativePath>%(DistFiles.Identity)</RelativePath>
        <CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
      </ResolvedFileToPublish>
    </ItemGroup>
  </Target>

</Project>
